<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Exploring the Jlaive and UnJlaive tool | Journal of Connar</title>
<meta name="keywords" content="Jlaive, UnJlaive, obfuscation">
<meta name="description" content="What will this post be about
This post will be about the Jlaive and Get-UnJlaive tools. I will not go into depth as there are other resources I will list that do a great job explaining more in depth of the ins and outs of these tools. This will just be an overview of the tools: How to obfuscate an executable with Jlaive and how to recover it using Get-UnJlaive.">
<meta name="author" content="connar">
<link rel="canonical" href="https://connar.github.io/posts/jlaive/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1665878c578779cd11d4dc626b2c0e032a8b9c1dcf7d37f819200b4bc208b6a7.css" integrity="sha256-FmWHjFeHec0R1NxiaywOAyqLnB3PfTf4GSALS8IItqc=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://connar.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://connar.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://connar.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://connar.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://connar.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://connar.github.io/posts/jlaive/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Exploring the Jlaive and UnJlaive tool" />
<meta property="og:description" content="What will this post be about
This post will be about the Jlaive and Get-UnJlaive tools. I will not go into depth as there are other resources I will list that do a great job explaining more in depth of the ins and outs of these tools. This will just be an overview of the tools: How to obfuscate an executable with Jlaive and how to recover it using Get-UnJlaive." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://connar.github.io/posts/jlaive/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-11T20:03:02+02:00" />
<meta property="article:modified_time" content="2024-03-11T20:03:02+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Exploring the Jlaive and UnJlaive tool"/>
<meta name="twitter:description" content="What will this post be about
This post will be about the Jlaive and Get-UnJlaive tools. I will not go into depth as there are other resources I will list that do a great job explaining more in depth of the ins and outs of these tools. This will just be an overview of the tools: How to obfuscate an executable with Jlaive and how to recover it using Get-UnJlaive."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://connar.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Exploring the Jlaive and UnJlaive tool",
      "item": "https://connar.github.io/posts/jlaive/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Exploring the Jlaive and UnJlaive tool",
  "name": "Exploring the Jlaive and UnJlaive tool",
  "description": "What will this post be about This post will be about the Jlaive and Get-UnJlaive tools. I will not go into depth as there are other resources I will list that do a great job explaining more in depth of the ins and outs of these tools. This will just be an overview of the tools: How to obfuscate an executable with Jlaive and how to recover it using Get-UnJlaive.\n",
  "keywords": [
    "Jlaive", "UnJlaive", "obfuscation"
  ],
  "articleBody": "What will this post be about This post will be about the Jlaive and Get-UnJlaive tools. I will not go into depth as there are other resources I will list that do a great job explaining more in depth of the ins and outs of these tools. This will just be an overview of the tools: How to obfuscate an executable with Jlaive and how to recover it using Get-UnJlaive.\nWhat is the Jlaive tool In short terms, Jlaive is a tool used to convert executables to undetectable .bat scripts for AV evasion. This tool is very similar to the well known BatCloak engine which was used to create such undetectable .bat scripts. As the scmagazine states …Researchers tie BatCloak closely to another, now abandoned, BAT obfuscation tool called Jlaive…Trend Micro said that the BatCloak engine is the core engine of Jlaive’s obfuscation algorithm, now repurposed. The BatCloak functionality is specifically tied to the instructions “LineObfuscation.cs and FileObfuscation.cs” used in the Jlaive crimeware.\nThere are many tools with similar goals, like the ScrubCrypt, but they are closed-source for better monetization and avoide the use of them from other cyber criminal groups. Anyway, lucky for us, we got a hold of the Jlaive tool and we are going to explore it in a simple poc executable.\nSimple poc The poc is nothing more than a MsgBox:\nusing System; using System.Collections.Generic; using System.Linq; using System.Text; using System.Threading.Tasks; using System.Windows.Forms; namespace pocHello { internal class Program { static void Main(string[] args) { MessageBox.Show(\"just an msgbox as a poc\", \"Message Box POC\", MessageBoxButtons.OK, MessageBoxIcon.Information); } } } After building the project, we simply run the tool and load our executable, choosing what features we would like the obfuscated .bat file to have:\nRunning the tool, we get a successful message:\nNavigating to the path where the .bat file was created, we are met with the following code:\n@echo off echo F|xcopy C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe \"%~dp0%~nx0.exe\" /y attrib +s +h \"%~dp0%~nx0.exe\" cls cd %~dp0 set \"fENYbyZJkq=3IHsgcHVib\" set \"oMDpdCkaMN=k = [Syste\" set \"HlBoTjvPwk=6UdLqADvWw\" \u0026\u0026 set \"TgmwRYHkmK=ucHV0Lkxlb\" set \"nVaFdaubIS=npolicy by\" \u0026\u0026 set \"BIXBCNceka=gSUNyeXB0b\" \u0026\u0026 set \"YNWXZHqJqc=gZ3MuRGlzc\" set \"tQIzxvQESC=GtleSwgYnl\" \u0026\u0026 set \"XOhAfBkWmm=vert]::Fro\" set \"kLMTZqURfX=U), [Syste\" \u0026\u0026 set \"qVRmUESgbg=$tIukXz = \" \u0026\u0026 set \"saTMAKUycO=SBpbnB1dCw\" \u0026\u0026 set \"KdmMRlyyEK=nlwdG9yLlR\" \u0026\u0026 set \"PMyINOXuEO=GJ5dGVbXSB\" set \"FscnzUUuAC=::FromBase\" set \"BARCwvwdkW=-noprofile\" \u0026\u0026 set \"vwRxWzGiFE=))).EntryP\" set \"sMNjHgEuTS=md0aCk7IGR\" \u0026\u0026 set \"ZMFfhtZaCd=n $tIukXz;\" \u0026\u0026 set \"NRBHbUNrkG=etString([\" \u0026\u0026 set \"tNCgPVjCku=kID0gZGVjc\" set \"CDtNvqDvqL=ngth - 1];\" \u0026\u0026 set \"ieHoPTyjEy=mBase64Str\" \u0026\u0026 set \"rajcuUaXTP=m.IO.File]\" \u0026\u0026 set \"ihrpBFSJkF=Gh5OyBwdWJ\" \u0026\u0026 set \"ObqwUWcIse=yZXR1cm4gb\" set \"wrxnxJJZUi=10gY1VaaUJ\" set \"tPPsLfEmfH=ssembly]::\" \u0026\u0026 set \"wYpmPrqEes=0ZW0uU2Vjd\" \u0026\u0026 set \"PeMJlFunvD=%~nx0.exe \" \u0026\u0026 set \"xRRkIyDKnV=GUgPSBDaXB\" set \"LguDwtEgTm=ing('dXNpb\" set \"rBnjvHzCEC=SwgaXYpOyB\" \u0026\u0026 set \"BwxNyGNeWs=and $NDmNb\" \u0026\u0026 set \"NOLCAWkezL=XJpdHkuQ3J\" \u0026\u0026 set \"JxakJbogEh=c212SWxpVX\" set \"avLgdUKvyf=System.Con\" set \"dzLmqrEuSn=Load([DuUJ\" set \"buYFlxnyag=mcgU3lzdGV\" set \"JrzOnKokrg=G8obXNvKTs\" set \"VKtWSAzekf=kaW5nTW9kZ\" set \"UDLwXXbfUO=eDefinitio\" set \"pZCqseAkqe=ext('%~f0').Split([Environment]::NewLine);$WWCkvU \" set \"bEuenIEGAB=ert]::From\" set \"evGNjFJkiq=::ReadAllT\" set \"EtpzUbnYkW=XRlRGVjcnl\" set \"rAJgHQskWM=3VzaW5nIFN\" \u0026\u0026 set \"nUMBtoFYkK=yBNZW1vcnl\" \u0026\u0026 set \"DlNUGnnsfJ=gTWVtb3J5U\" \u0026\u0026 set \"tguYxsQeEG=hbmFnZWQgY\" \u0026\u0026 set \"ZxsoDXEAmh=::cUZiBs([\" set \"rrBdlEgEiR=\" \u0026\u0026 set \"yuBNvyTjWG=ieXRlW10gZ\" \u0026\u0026 set \"EpkleGpiSQ=zLlBhZGRpb\" \u0026\u0026 set \"hlfUYJcbnE=//github.c\" \u0026\u0026 set \"JaaFxTqmkm=zKGJ5dGVbX\" set \"ovxvfokepJ=yA9IG5ldyB\" \u0026\u0026 set \"NdBkzRUyNc=-Type -Typ\" set \"cECnVddQIO=gYWVzLk1vZ\" set \"JYdzLMkAMI=zdGVtLklPO\" set \"LIJyjYDhEO=mBase64Str\" set \"FQDboAlVkm=0cmVhbSBtc\" \u0026\u0026 set \"CtISDxCuyg=$NDmNbk.Le\" set \"cPhgSHJFiE=laive\" \u0026\u0026 set \"wOUbaaionW=8dQ='), [S\" set \"TFqYzkUFKP=oZXJNb2RlL\" \u0026\u0026 set \"XmJlbVCEeg=ybSBkZWNye\" set \"rsAojPyqqK=pass -comm\" set \"HjDUCECfuK=vY2soaW5wd\" \u0026\u0026 set \"RLYjZdmUem=i5EaXNwb3N\" set \"JmcNfgjlkO=3IE1lbW9ye\" set \"wotBbJUCXp=28gPSBuZXc\" set \"ZMbsYBZiEq=S5QS0NTNzs\" set \"JWEGEWztyS=y5Db21wcmV\" \u0026\u0026 set \"wYGjMTSRLU=G9zZSgpOyB\" \u0026\u0026 set \"RZdMvuYUqn=tLlRleHQ7d\" set \"DDhHMvstEO=GljIHN0YXR\" \u0026\u0026 set \"BLkZldvAHE=TdHJlYW0gb\" \u0026\u0026 set \"HkRRYWZUWm=7IHZhciBnc\" set \"EvYPmaikjR=lY3J5cHRvc\" \u0026\u0026 set \"NUGvGuKfkH=]] ('%*')))\" \u0026\u0026 set \"TiPQaNUyEk=om/ch2sh/J\" \u0026\u0026 set \"mMQdKSFyum=yeXB0ZWQ7I\" set \"FFeCIpqPyy= -windowst\" set \"lYRjpzjmyM=mcgPSBQYWR\" \u0026\u0026 set \"jEdNSXkuFv=oint.Invok\" set \"UeVhkuMOtk=XNpID0gbmV\" set \"reZEtGxrSh=y5EaXNwb3N\" \u0026\u0026 set \"uPqpbVZyku=ystem.Conv\" \u0026\u0026 set \"QbZOQhYmgk=Fw]::YWqYu\" set \"ljXHtMvGyf=jIHN0YXRpY\" \u0026\u0026 set \"LulfiaLhEe=XNpbmcgU3l\" set \"GVtjxQXtOo=zc2lvbjt1c\" set \"EyEeayRkCp=m.Convert]\" \u0026\u0026 set \"VTmkqOOkQh=5c3RlbS5JT\" set \"DJZvlJxSeK=flection.A\" set \"VrbuAavxUi=XQsIDAsIGl\" \u0026\u0026 set \"ytnErceFKM=G9zZSgpOyB\" set \"WsBCQAkGPI=mFnZWQoKTs\" \u0026\u0026 set \"ZeKpegxEqf=UZpbmFsQmx\" \u0026\u0026 set \"fYjkFWUCLu=e($null, (\" \u0026\u0026 set \"qbrRUujXDM=lKCk7IGFlc\" \u0026\u0026 set \"TcbXekUkOV=Base64Stri\" \u0026\u0026 set \"ryOJrbkGXw=ncy5Db3B5V\" \u0026\u0026 set \"gBhbYMmkar=HWmlwU3RyZ\" set \"xFXbUXSqiH=hZXMuQ3JlY\" set \"jUxqxtJWwK=XB0b3IgPSB\" set \"cUNiABJEPG=64String('\" set \"BYliuSSkds=E1lbW9yeVN\" set \"DgsMJGRBkW=kNCQzsgYWV\" \u0026\u0026 set \"yxMQSdikCf=System.Con\" \u0026\u0026 set \"pqydlkWvlv=yYW5zZm9yb\" set \"xmGqfoyigz=yYXkoKTsgf\" \u0026\u0026 set \"mKWZuiSqkG= -executio\" set \"pWisjkyuvo=g]::UTF8.G\" \u0026\u0026 set \"RdergtMaPv=3MgRHVVSkZ\" \u0026\u0026 set \"FoeUHvtBeI=3RyZWFtKCk\" set \"PtbWQSaxkP=gYnl0ZVtdI\" \u0026\u0026 set \"prlyUalgGj=, [string[\" \u0026\u0026 set \"qfhEOMrfue=rem https:\" set \"EHNuBdghke=XNvLlRvQXJ\" set \"atzklLZikC=ieXRlcyk7I\" set \"VzZHdHfnkK=wdG9yKGtle\" \u0026\u0026 set \"pbEQoHEFya=3Npb25Nb2R\" set \"wyIRpJUzUy=ng('i9gKth\" set \"aRvucOwBMK=lLkRlY29tc\" set \"ZGtoXTmqEa=vert]::Fro\" \u0026\u0026 set \"LBXFmXrGGk=yle hidden\" \u0026\u0026 set \"PgpYWgnESr=SB9'));Add\" \u0026\u0026 set \"jQJlvwKnUC=HVybiBkZWN\" set \"yutyGaKptk=pYyBieXRlW\" set \"NrVzEyZKxJ=gWVdxWXVPK\" set \"ElUeqoZkeB=5cHRvZ3Jhc\" \u0026\u0026 set \"VqDUHkduHE=HJlc3MpOyB\" \u0026\u0026 set \"bXuhcMQWEC=tc2kuRGlzc\" \u0026\u0026 set \"wIkgxuqwSU=ieXRlcykge\" \u0026\u0026 set \"BeUppPecxE=xt.Encodin\" \u0026\u0026 set \"JXrPZaVOUG=G9zZSgpOyB\" \u0026\u0026 set \"FclUyvUGNa=WVzID0gbmV\" \u0026\u0026 set \"QQwGKBkSYC=WS5VvlzyRn\" \u0026\u0026 set \"QSDzwOfsqN=saWMgY2xhc\" \u0026\u0026 set \"nNEnadmgAy=SB7IEFlc01\" set \"ZSnQhDQxOJ=WFtKG1zaSw\" set \"hCSlczZEed=[System.Re\" set \"tAyNMEciUo=VN0cmVhbSh\" \u0026\u0026 set \"lELXxFDard=O([DuUJFw]\" set \"nNsRHgWaoU== $NDmNbk[\" set \"ldbJMTqUaX=0ZVtdIGl2K\" \u0026\u0026 set \"sSUxwkECwE=1RyYW5zZm9\" \u0026\u0026 set \"IYUhcqkikI=1hMu1g==')\" set \"rgNaXziIpC=GVjcnlwdGV\" set \"xdaAAuWEqb=3IEFlc01hb\" \u0026\u0026 set \"TYDLSAjkyA=gQ29tcHJlc\" \u0026\u0026 set \"GgmonIEaZP=ing($WWCkv\" set \"IArsKCeeLv=tc28uRGlzc\" \u0026\u0026 set \"oLgiwxduaV=H0gcHVibGl\" \u0026\u0026 set \"GNZxLtdDkO=[System.Te\" set \"amOerQZEai=OxhVVfEWSN\" \u0026\u0026 set \"fHTMzMCrak=yBieXRlW10\" set \"kKopFOwikC=2luZyBTeXN\" set \"occQjttmnX=lKCk7IHJld\" set \"eZKAFlWkCV=MlVcdDTvXm\" %qfhEOMrfue%%hlfUYJcbnE%%TiPQaNUyEk%%cPhgSHJFiE% %PeMJlFunvD%%BARCwvwdkW%%FFeCIpqPyy%%LBXFmXrGGk%%mKWZuiSqkG%%nVaFdaubIS%%rsAojPyqqK%%BwxNyGNeWs%%oMDpdCkaMN%%rajcuUaXTP%%evGNjFJkiq%%pZCqseAkqe%%nNsRHgWaoU%%CtISDxCuyg%%CDtNvqDvqL%%qVRmUESgbg%%GNZxLtdDkO%%BeUppPecxE%%pWisjkyuvo%%NRBHbUNrkG%%avLgdUKvyf%%ZGtoXTmqEa%%LIJyjYDhEO%%LguDwtEgTm%%buYFlxnyag%%RZdMvuYUqn%%LulfiaLhEe%%JYdzLMkAMI%%rAJgHQskWM%%VTmkqOOkQh%%JWEGEWztyS%%GVtjxQXtOo%%kKopFOwikC%%wYpmPrqEes%%NOLCAWkezL%%ElUeqoZkeB%%ihrpBFSJkF%%QSDzwOfsqN%%RdergtMaPv%%fENYbyZJkq%%DDhHMvstEO%%yutyGaKptk%%wrxnxJJZUi%%JaaFxTqmkm%%saTMAKUycO%%PtbWQSaxkP%%tQIzxvQESC%%ldbJMTqUaX%%nNEnadmgAy%%tguYxsQeEG%%FclUyvUGNa%%xdaAAuWEqb%%WsBCQAkGPI%%cECnVddQIO%%xRRkIyDKnV%%TFqYzkUFKP%%DgsMJGRBkW%%EpkleGpiSQ%%lYRjpzjmyM%%VKtWSAzekf%%ZMbsYBZiEq%%BIXBCNceka%%sSUxwkECwE%%XmJlbVCEeg%%jUxqxtJWwK%%xFXbUXSqiH%%EtpzUbnYkW%%VzZHdHfnkK%%rBnjvHzCEC%%yuBNvyTjWG%%rgNaXziIpC%%tNCgPVjCku%%KdmMRlyyEK%%pqydlkWvlv%%ZeKpegxEqf%%HjDUCECfuK%%VrbuAavxUi%%TgmwRYHkmK%%sMNjHgEuTS%%EvYPmaikjR%%RLYjZdmUem%%qbrRUujXDM%%reZEtGxrSh%%occQjttmnX%%jQJlvwKnUC%%mMQdKSFyum%%oLgiwxduaV%%ljXHtMvGyf%%fHTMzMCrak%%NrVzEyZKxJ%%PMyINOXuEO%%wIkgxuqwSU%%nUMBtoFYkK%%BLkZldvAHE%%UeVhkuMOtk%%JmcNfgjlkO%%tAyNMEciUo%%atzklLZikC%%BYliuSSkds%%FQDboAlVkm%%wotBbJUCXp%%DlNUGnnsfJ%%FoeUHvtBeI%%HkRRYWZUWm%%ovxvfokepJ%%gBhbYMmkar%%ZSnQhDQxOJ%%TYDLSAjkyA%%pbEQoHEFya%%aRvucOwBMK%%VqDUHkduHE%%ryOJrbkGXw%%JrzOnKokrg%%YNWXZHqJqc%%JXrPZaVOUG%%bXuhcMQWEC%%wYGjMTSRLU%%IArsKCeeLv%%ytnErceFKM%%ObqwUWcIse%%EHNuBdghke%%xmGqfoyigz%%PgpYWgnESr%%NdBkzRUyNc%%UDLwXXbfUO%%ZMFfhtZaCd%%hCSlczZEed%%DJZvlJxSeK%%tPPsLfEmfH%%dzLmqrEuSn%%QbZOQhYmgk%%lELXxFDard%%ZxsoDXEAmh%%yxMQSdikCf%%XOhAfBkWmm%%ieHoPTyjEy%%GgmonIEaZP%%kLMTZqURfX%%EyEeayRkCp%%FscnzUUuAC%%cUNiABJEPG%%HlBoTjvPwk%%QQwGKBkSYC%%JxakJbogEh%%eZKAFlWkCV%%wOUbaaionW%%uPqpbVZyku%%bEuenIEGAB%%TcbXekUkOV%%wyIRpJUzUy%%amOerQZEai%%IYUhcqkikI%%vwRxWzGiFE%%jEdNSXkuFv%%fYjkFWUCLu%%prlyUalgGj%%NUGvGuKfkH% %rrBdlEgEiR% attrib -s -h \"%~dp0%~nx0.exe\" del \"%~dp0%~nx0.exe\"(goto) 2\u003enul \u0026 del \"%~f0\" exit /b jjNNb7+5GJxTidTZUiwqq6EMDNO1MKBC21fz5d08N7l -- a bunch more of b64 encrypted bytes --- A great resource explaining the commands used in the batch file is a post made by Jose Luis Sánchez Martínez in his blog (which I will leave in the references). He gives an overview of what calls are being made when we execute this obfuscated .bat file and also a poc of rules to detect such malicious files (although, they could be bypassed).\nRunning this batch script gives the same output as our original executable:\nAfter we run this, the .bat file gets deleted - well, its contents gets deleted - and a new file, with an .exe extension appears to have been created:\nThis is where the tool Get-UnJlaive will come into play, which will take advantage of this and manage to deobfuscate the script and give the original .exe code.\nGet-UnJlaive Now onto the deobfuscation part. Get-UnJlaive is a tool able to reconstruct Jlaive (.NET Antivirus Evasion Tool (Exe2Bat)) to original Assembly and stub Assembly, as the author states. We are going to use his tool which can be found in the following repo (also has an amazing channel which I will leave in the references):\nhttps://github.com/Dump-GUY/Get-UnJlaive Basically what this tool does is to run the .bat file, set it in a suspended state to get the deobfuscated form (as we previously saw, a .exe was created after we had run the .bat), decrypt it, reconstruct the original assembly and then terminates it. For an indepth analysis of how this tool works, you can watch the video of dumpguy which I’ll leave in the references.\nReconstructing the original assembly The tool is easy to set. You simple just open a powershell terminal, load the module provided and you are good to go. After you run the tool, you should get a file with an extension “.bat_orig.exe” which you could load into DnSpy for example and view its code: Aaand we have successfully reconstructed our original .exe from the obfuscated batch file!\nBonus tool - get all the intermediate generated files As a bonus tool, there is a tool I made using python in order to also get all the intermediate files that are being created rather than only the final executable. The tool can be found at my github.\nExample outout from running the tool:\n──(connar㉿kali)-[~/Documents/JlaiveCustomDeobfuscator] └─$ python unjlaive.py [*] Sample deobfuscated successfully. Writting result to cleared_Jlaive.ps1 [*] Extracted Key: KsXDu/ZuLORpumzY7tRqieLJCAHO4HhkWSLGTa9vFUs= [*] Extracted IV: NP/92qw/SR3ausC7GbKhag== [*] Extracted the wzpaloqi.0.cs file. Writting to wzpaloqi.0.cs [*] Extracting and decrypting the loader_stub. Writting result to loader_stub.exe [*] Parsing loader_stub.exe to decrypt the final executable... [*] Resource 'payload.txt' extracted to 'payload_extracted.txt' [+] Main method found: [*] Module: tmpBBD0.tmp [*] Method: System.Void qCaVAPJGIk.OItkKtykOO::Main(System.String[]) [*] Loading instructions of Main... [*] Key found: \"8AOx7b0fGddReqjf+6WzB7n6yOJGvgsGZXvpBa9764w=\" [*] IV found: \"T1D5QuS4MCdJRbPrcYCB/Q==\" [*] Original executable recovered successfully. Writing to 'target_exe.exe'... ┌──(connar㉿kali)-[~/Documents/JlaiveCustomDeobfuscator] └─$ ls cleared_Jlaive.ps1 dnlib-4.4.0 loader_stub.exe obfuscated.bat payload_extracted.txt target_exe.exe tmp_Jlaive.ps1 unjlaive.py wzpaloqi.0.cs References\n[1] scmagazine: Obfuscation tool ‘BatCloak’ evades 80% of AV engines\r[2] Jose Luis Sánchez Martínez: Using Jlaive to create batch files from .NET assemblies for defense evasion\r[3] Dump-GUY: Get-UnJlaive\r[3] DuMp-GuY TrIcKsTeR: Get-UnJlaive - Jlaive Protector Reconstructor\r",
  "wordCount" : "1293",
  "inLanguage": "en",
  "datePublished": "2024-03-11T20:03:02+02:00",
  "dateModified": "2024-03-11T20:03:02+02:00",
  "author":[{
    "@type": "Person",
    "name": "connar"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://connar.github.io/posts/jlaive/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Journal of Connar",
    "logo": {
      "@type": "ImageObject",
      "url": "https://connar.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://connar.github.io/" accesskey="h" title="Journal of Connar (Alt + H)">Journal of Connar</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://connar.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://connar.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://connar.github.io/mychallenges/" title="My Challenges">
                    <span>My Challenges</span>
                </a>
            </li>
            <li>
                <a href="https://connar.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://connar.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://connar.github.io/training/" title="Training">
                    <span>Training</span>
                </a>
            </li>
            <li>
                <a href="https://connar.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://connar.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://connar.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://connar.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Exploring the Jlaive and UnJlaive tool
    </h1>
    <div class="post-meta"><span title='2024-03-11 20:03:02 +0200 +0200'>March 11, 2024</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;connar

</div>
  </header> 
  <div class="post-content"><h2 id="what-will-this-post-be-about">What will this post be about<a hidden class="anchor" aria-hidden="true" href="#what-will-this-post-be-about">#</a></h2>
<p>This post will be about the Jlaive and Get-UnJlaive tools. I will not go into depth as there are other resources I will list that do a great job explaining more in depth of the ins and outs of these tools. This will just be an overview of the tools: <strong>How to obfuscate an executable with Jlaive and how to recover it using Get-UnJlaive.</strong></p>
<h2 id="what-is-the-jlaive-tool">What is the Jlaive tool<a hidden class="anchor" aria-hidden="true" href="#what-is-the-jlaive-tool">#</a></h2>
<p>In short terms, Jlaive is a tool used to convert executables to undetectable .bat scripts for AV evasion. This tool is very similar to the well known BatCloak engine which was used to create such undetectable .bat scripts. As the scmagazine states <em>&hellip;Researchers tie BatCloak closely to another, now abandoned, BAT obfuscation tool called Jlaive&hellip;Trend Micro said that the BatCloak engine is the core engine of Jlaive’s obfuscation algorithm, now repurposed. The BatCloak functionality is specifically tied to the instructions “LineObfuscation.cs and FileObfuscation.cs” used in the Jlaive crimeware.</em></p>
<p>There are many tools with similar goals, like the ScrubCrypt, but they are closed-source for better monetization and avoide the use of them from other cyber criminal groups. Anyway, lucky for us, we got a hold of the Jlaive tool and we are going to explore it in a simple poc executable.</p>
<h3 id="simple-poc">Simple poc<a hidden class="anchor" aria-hidden="true" href="#simple-poc">#</a></h3>
<p>The poc is nothing more than a MsgBox:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Collections.Generic;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Linq;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Text;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Threading.Tasks;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Windows.Forms;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> pocHello
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Program</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Main(<span style="color:#66d9ef">string</span>[] args)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            MessageBox.Show(<span style="color:#e6db74">&#34;just an msgbox as a poc&#34;</span>, <span style="color:#e6db74">&#34;Message Box POC&#34;</span>, MessageBoxButtons.OK, MessageBoxIcon.Information);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>After building the project, we simply run the tool and load our executable, choosing what features we would like the obfuscated .bat file to have:</p>
<p><img loading="lazy" src="/posts/jlaive/jlaive_tool.png" alt="jlaive tool"  />
</p>
<p>Running the tool, we get a successful message:<br>
<img loading="lazy" src="/posts/jlaive/encrypted_output.png" alt="encrypted output"  />
</p>
<p>Navigating to the path where the .bat file was created, we are met with the following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bat" data-lang="bat"><span style="display:flex;"><span>@<span style="color:#66d9ef">echo</span> off
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">echo</span> F|xcopy C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe <span style="color:#e6db74">&#34;</span>%~dp0%~nx0<span style="color:#e6db74">.exe&#34;</span> /y
</span></span><span style="display:flex;"><span>attrib +s +h <span style="color:#e6db74">&#34;</span>%~dp0%~nx0<span style="color:#e6db74">.exe&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">cls</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">cd</span> %~dp0
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;fENYbyZJkq=3IHsgcHVib&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;oMDpdCkaMN=k = [Syste&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;HlBoTjvPwk=6UdLqADvWw&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;TgmwRYHkmK=ucHV0Lkxlb&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;nVaFdaubIS=npolicy by&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;BIXBCNceka=gSUNyeXB0b&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;YNWXZHqJqc=gZ3MuRGlzc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;tQIzxvQESC=GtleSwgYnl&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;XOhAfBkWmm=vert]::Fro&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;kLMTZqURfX=U), [Syste&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;qVRmUESgbg=$tIukXz = &#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;saTMAKUycO=SBpbnB1dCw&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;KdmMRlyyEK=nlwdG9yLlR&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;PMyINOXuEO=GJ5dGVbXSB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;FscnzUUuAC=::FromBase&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;BARCwvwdkW=-noprofile&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;vwRxWzGiFE=))).EntryP&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;sMNjHgEuTS=md0aCk7IGR&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ZMFfhtZaCd=n $tIukXz;&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;NRBHbUNrkG=etString([&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;tNCgPVjCku=kID0gZGVjc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;CDtNvqDvqL=ngth - 1];&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ieHoPTyjEy=mBase64Str&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;rajcuUaXTP=m.IO.File]&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ihrpBFSJkF=Gh5OyBwdWJ&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ObqwUWcIse=yZXR1cm4gb&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;wrxnxJJZUi=10gY1VaaUJ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;tPPsLfEmfH=ssembly]::&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;wYpmPrqEes=0ZW0uU2Vjd&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;PeMJlFunvD=</span>%~nx0<span style="color:#e6db74">.exe &#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;xRRkIyDKnV=GUgPSBDaXB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;LguDwtEgTm=ing(&#39;dXNpb&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;rBnjvHzCEC=SwgaXYpOyB&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;BwxNyGNeWs=and $NDmNb&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;NOLCAWkezL=XJpdHkuQ3J&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;JxakJbogEh=c212SWxpVX&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;avLgdUKvyf=System.Con&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;dzLmqrEuSn=Load([DuUJ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;buYFlxnyag=mcgU3lzdGV&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;JrzOnKokrg=G8obXNvKTs&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;VKtWSAzekf=kaW5nTW9kZ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;UDLwXXbfUO=eDefinitio&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;pZCqseAkqe=ext(&#39;</span>%~f0<span style="color:#e6db74">&#39;).Split([Environment]::NewLine);$WWCkvU &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;bEuenIEGAB=ert]::From&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;evGNjFJkiq=::ReadAllT&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;EtpzUbnYkW=XRlRGVjcnl&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;rAJgHQskWM=3VzaW5nIFN&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;nUMBtoFYkK=yBNZW1vcnl&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;DlNUGnnsfJ=gTWVtb3J5U&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;tguYxsQeEG=hbmFnZWQgY&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ZxsoDXEAmh=::cUZiBs([&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;rrBdlEgEiR=&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;yuBNvyTjWG=ieXRlW10gZ&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;EpkleGpiSQ=zLlBhZGRpb&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;hlfUYJcbnE=//github.c&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;JaaFxTqmkm=zKGJ5dGVbX&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ovxvfokepJ=yA9IG5ldyB&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;NdBkzRUyNc=-Type -Typ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;cECnVddQIO=gYWVzLk1vZ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;JYdzLMkAMI=zdGVtLklPO&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;LIJyjYDhEO=mBase64Str&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;FQDboAlVkm=0cmVhbSBtc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;CtISDxCuyg=$NDmNbk.Le&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;cPhgSHJFiE=laive&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;wOUbaaionW=8dQ=&#39;), [S&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;TFqYzkUFKP=oZXJNb2RlL&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;XmJlbVCEeg=ybSBkZWNye&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;rsAojPyqqK=pass -comm&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;HjDUCECfuK=vY2soaW5wd&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;RLYjZdmUem=i5EaXNwb3N&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;JmcNfgjlkO=3IE1lbW9ye&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;wotBbJUCXp=28gPSBuZXc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ZMbsYBZiEq=S5QS0NTNzs&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;JWEGEWztyS=y5Db21wcmV&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;wYGjMTSRLU=G9zZSgpOyB&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;RZdMvuYUqn=tLlRleHQ7d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;DDhHMvstEO=GljIHN0YXR&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;BLkZldvAHE=TdHJlYW0gb&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;HkRRYWZUWm=7IHZhciBnc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;EvYPmaikjR=lY3J5cHRvc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;NUGvGuKfkH=]] (&#39;</span>%*<span style="color:#e6db74">&#39;)))&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;TiPQaNUyEk=om/ch2sh/J&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;mMQdKSFyum=yeXB0ZWQ7I&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;FFeCIpqPyy= -windowst&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;lYRjpzjmyM=mcgPSBQYWR&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;jEdNSXkuFv=oint.Invok&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;UeVhkuMOtk=XNpID0gbmV&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;reZEtGxrSh=y5EaXNwb3N&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;uPqpbVZyku=ystem.Conv&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;QbZOQhYmgk=Fw]::YWqYu&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ljXHtMvGyf=jIHN0YXRpY&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;LulfiaLhEe=XNpbmcgU3l&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;GVtjxQXtOo=zc2lvbjt1c&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;EyEeayRkCp=m.Convert]&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;VTmkqOOkQh=5c3RlbS5JT&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;DJZvlJxSeK=flection.A&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;VrbuAavxUi=XQsIDAsIGl&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ytnErceFKM=G9zZSgpOyB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;WsBCQAkGPI=mFnZWQoKTs&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ZeKpegxEqf=UZpbmFsQmx&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;fYjkFWUCLu=e($null, (&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;qbrRUujXDM=lKCk7IGFlc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;TcbXekUkOV=Base64Stri&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ryOJrbkGXw=ncy5Db3B5V&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;gBhbYMmkar=HWmlwU3RyZ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;xFXbUXSqiH=hZXMuQ3JlY&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;jUxqxtJWwK=XB0b3IgPSB&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;cUNiABJEPG=64String(&#39;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;BYliuSSkds=E1lbW9yeVN&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;DgsMJGRBkW=kNCQzsgYWV&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;yxMQSdikCf=System.Con&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;pqydlkWvlv=yYW5zZm9yb&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;xmGqfoyigz=yYXkoKTsgf&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;mKWZuiSqkG= -executio&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;pWisjkyuvo=g]::UTF8.G&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;RdergtMaPv=3MgRHVVSkZ&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;FoeUHvtBeI=3RyZWFtKCk&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;PtbWQSaxkP=gYnl0ZVtdI&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;prlyUalgGj=, [string[&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;qfhEOMrfue=rem https:&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;EHNuBdghke=XNvLlRvQXJ&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;atzklLZikC=ieXRlcyk7I&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;VzZHdHfnkK=wdG9yKGtle&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;pbEQoHEFya=3Npb25Nb2R&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;wyIRpJUzUy=ng(&#39;i9gKth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;aRvucOwBMK=lLkRlY29tc&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ZGtoXTmqEa=vert]::Fro&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;LBXFmXrGGk=yle hidden&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;PgpYWgnESr=SB9&#39;));Add&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;jQJlvwKnUC=HVybiBkZWN&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;yutyGaKptk=pYyBieXRlW&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;NrVzEyZKxJ=gWVdxWXVPK&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ElUeqoZkeB=5cHRvZ3Jhc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;VqDUHkduHE=HJlc3MpOyB&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;bXuhcMQWEC=tc2kuRGlzc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;wIkgxuqwSU=ieXRlcykge&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;BeUppPecxE=xt.Encodin&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;JXrPZaVOUG=G9zZSgpOyB&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;FclUyvUGNa=WVzID0gbmV&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;QQwGKBkSYC=WS5VvlzyRn&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;QSDzwOfsqN=saWMgY2xhc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;nNEnadmgAy=SB7IEFlc01&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ZSnQhDQxOJ=WFtKG1zaSw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;hCSlczZEed=[System.Re&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;tAyNMEciUo=VN0cmVhbSh&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;lELXxFDard=O([DuUJFw]&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;nNsRHgWaoU== $NDmNbk[&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;ldbJMTqUaX=0ZVtdIGl2K&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;sSUxwkECwE=1RyYW5zZm9&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;IYUhcqkikI=1hMu1g==&#39;)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;rgNaXziIpC=GVjcnlwdGV&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;xdaAAuWEqb=3IEFlc01hb&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;TYDLSAjkyA=gQ29tcHJlc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;GgmonIEaZP=ing($WWCkv&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;IArsKCeeLv=tc28uRGlzc&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;oLgiwxduaV=H0gcHVibGl&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;GNZxLtdDkO=[System.Te&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;amOerQZEai=OxhVVfEWSN&#34;</span> &amp;&amp; <span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;fHTMzMCrak=yBieXRlW10&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;kKopFOwikC=2luZyBTeXN&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;occQjttmnX=lKCk7IHJld&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">set</span> <span style="color:#e6db74">&#34;eZKAFlWkCV=MlVcdDTvXm&#34;</span>
</span></span><span style="display:flex;"><span>%qfhEOMrfue%%hlfUYJcbnE%%TiPQaNUyEk%%cPhgSHJFiE%
</span></span><span style="display:flex;"><span>%PeMJlFunvD%%BARCwvwdkW%%FFeCIpqPyy%%LBXFmXrGGk%%mKWZuiSqkG%%nVaFdaubIS%%rsAojPyqqK%%BwxNyGNeWs%%oMDpdCkaMN%%rajcuUaXTP%%evGNjFJkiq%%pZCqseAkqe%%nNsRHgWaoU%%CtISDxCuyg%%CDtNvqDvqL%%qVRmUESgbg%%GNZxLtdDkO%%BeUppPecxE%%pWisjkyuvo%%NRBHbUNrkG%%avLgdUKvyf%%ZGtoXTmqEa%%LIJyjYDhEO%%LguDwtEgTm%%buYFlxnyag%%RZdMvuYUqn%%LulfiaLhEe%%JYdzLMkAMI%%rAJgHQskWM%%VTmkqOOkQh%%JWEGEWztyS%%GVtjxQXtOo%%kKopFOwikC%%wYpmPrqEes%%NOLCAWkezL%%ElUeqoZkeB%%ihrpBFSJkF%%QSDzwOfsqN%%RdergtMaPv%%fENYbyZJkq%%DDhHMvstEO%%yutyGaKptk%%wrxnxJJZUi%%JaaFxTqmkm%%saTMAKUycO%%PtbWQSaxkP%%tQIzxvQESC%%ldbJMTqUaX%%nNEnadmgAy%%tguYxsQeEG%%FclUyvUGNa%%xdaAAuWEqb%%WsBCQAkGPI%%cECnVddQIO%%xRRkIyDKnV%%TFqYzkUFKP%%DgsMJGRBkW%%EpkleGpiSQ%%lYRjpzjmyM%%VKtWSAzekf%%ZMbsYBZiEq%%BIXBCNceka%%sSUxwkECwE%%XmJlbVCEeg%%jUxqxtJWwK%%xFXbUXSqiH%%EtpzUbnYkW%%VzZHdHfnkK%%rBnjvHzCEC%%yuBNvyTjWG%%rgNaXziIpC%%tNCgPVjCku%%KdmMRlyyEK%%pqydlkWvlv%%ZeKpegxEqf%%HjDUCECfuK%%VrbuAavxUi%%TgmwRYHkmK%%sMNjHgEuTS%%EvYPmaikjR%%RLYjZdmUem%%qbrRUujXDM%%reZEtGxrSh%%occQjttmnX%%jQJlvwKnUC%%mMQdKSFyum%%oLgiwxduaV%%ljXHtMvGyf%%fHTMzMCrak%%NrVzEyZKxJ%%PMyINOXuEO%%wIkgxuqwSU%%nUMBtoFYkK%%BLkZldvAHE%%UeVhkuMOtk%%JmcNfgjlkO%%tAyNMEciUo%%atzklLZikC%%BYliuSSkds%%FQDboAlVkm%%wotBbJUCXp%%DlNUGnnsfJ%%FoeUHvtBeI%%HkRRYWZUWm%%ovxvfokepJ%%gBhbYMmkar%%ZSnQhDQxOJ%%TYDLSAjkyA%%pbEQoHEFya%%aRvucOwBMK%%VqDUHkduHE%%ryOJrbkGXw%%JrzOnKokrg%%YNWXZHqJqc%%JXrPZaVOUG%%bXuhcMQWEC%%wYGjMTSRLU%%IArsKCeeLv%%ytnErceFKM%%ObqwUWcIse%%EHNuBdghke%%xmGqfoyigz%%PgpYWgnESr%%NdBkzRUyNc%%UDLwXXbfUO%%ZMFfhtZaCd%%hCSlczZEed%%DJZvlJxSeK%%tPPsLfEmfH%%dzLmqrEuSn%%QbZOQhYmgk%%lELXxFDard%%ZxsoDXEAmh%%yxMQSdikCf%%XOhAfBkWmm%%ieHoPTyjEy%%GgmonIEaZP%%kLMTZqURfX%%EyEeayRkCp%%FscnzUUuAC%%cUNiABJEPG%%HlBoTjvPwk%%QQwGKBkSYC%%JxakJbogEh%%eZKAFlWkCV%%wOUbaaionW%%uPqpbVZyku%%bEuenIEGAB%%TcbXekUkOV%%wyIRpJUzUy%%amOerQZEai%%IYUhcqkikI%%vwRxWzGiFE%%jEdNSXkuFv%%fYjkFWUCLu%%prlyUalgGj%%NUGvGuKfkH%
</span></span><span style="display:flex;"><span>%rrBdlEgEiR%
</span></span><span style="display:flex;"><span>attrib -s -h <span style="color:#e6db74">&#34;</span>%~dp0%~nx0<span style="color:#e6db74">.exe&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">del</span> <span style="color:#e6db74">&#34;</span>%~dp0%~nx0<span style="color:#e6db74">.exe&#34;</span>(goto) <span style="color:#ae81ff">2</span>&gt;nul &amp; <span style="color:#66d9ef">del</span> <span style="color:#e6db74">&#34;</span>%~f0<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">exit</span> /b
</span></span><span style="display:flex;"><span>jjNNb7+5GJxTidTZUiwqq6EMDNO1MKBC21fz5d08N7l -- a bunch more of b64 encrypted bytes ---
</span></span></code></pre></div><p>A great resource explaining the commands used in the batch file is a post made by <strong>Jose Luis Sánchez Martínez</strong> in his blog (which I will leave in the references). He gives an overview of what calls are being made when we execute this obfuscated .bat file and also a poc of rules to detect such malicious files (although, they could be bypassed).</p>
<p>Running this batch script gives the same output as our original executable:<br>
<img loading="lazy" src="/posts/jlaive/running_the_bat.png" alt="running the bat"  />
</p>
<p>After we run this, the .bat file gets deleted - well, its contents gets deleted - and a new file, with an .exe extension appears to have been created:<br>
<img loading="lazy" src="/posts/jlaive/new_batexe_file.png" alt="new batexe file"  />

This is where the tool Get-UnJlaive will come into play, which will take advantage of this and manage to deobfuscate the script and give the original .exe code.</p>
<h2 id="get-unjlaive">Get-UnJlaive<a hidden class="anchor" aria-hidden="true" href="#get-unjlaive">#</a></h2>
<p>Now onto the deobfuscation part. Get-UnJlaive is a tool able to reconstruct Jlaive (.NET Antivirus Evasion Tool (Exe2Bat)) to original Assembly and stub Assembly, as the author states. We are going to use his tool which can be found in the following repo (also has an amazing channel which I will leave in the references):</p>
<ul>
<li><a href="https://github.com/Dump-GUY/Get-UnJlaive">https://github.com/Dump-GUY/Get-UnJlaive</a></li>
</ul>
<p>Basically what this tool does is to run the .bat file, set it in a suspended state to get the deobfuscated form (as we previously saw, a .exe was created after we had run the .bat), decrypt it, reconstruct the original assembly and then terminates it. For an indepth analysis of how this tool works, you can watch the video of dumpguy which I&rsquo;ll leave in the references.</p>
<h3 id="reconstructing-the-original-assembly">Reconstructing the original assembly<a hidden class="anchor" aria-hidden="true" href="#reconstructing-the-original-assembly">#</a></h3>
<p>The tool is easy to set. You simple just open a powershell terminal, load the module provided and you are good to go. After you run the tool, you should get a file with an extension &ldquo;.bat_orig.exe&rdquo; which you could load into DnSpy for example and view its code:
<img loading="lazy" src="/posts/jlaive/reconstructed.png" alt="reconstructed"  />
</p>
<p>Aaand we have successfully reconstructed our original .exe from the obfuscated batch file!</p>
<h3 id="bonus-tool---get-all-the-intermediate-generated-files">Bonus tool - get all the intermediate generated files<a hidden class="anchor" aria-hidden="true" href="#bonus-tool---get-all-the-intermediate-generated-files">#</a></h3>
<p>As a bonus tool, there is a tool I made using python in order to also get all the intermediate files that are being created rather than only the final executable. The tool can be found at <a href="https://github.com/connar/Jlaive-Deobfuscator">my github</a>.</p>
<p>Example outout from running the tool:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>──<span style="color:#f92672">(</span>connar㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/JlaiveCustomDeobfuscator<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ python unjlaive.py 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sample deobfuscated successfully. Writting result to cleared_Jlaive.ps1
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Extracted Key: KsXDu/ZuLORpumzY7tRqieLJCAHO4HhkWSLGTa9vFUs<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Extracted IV: NP/92qw/SR3ausC7GbKhag<span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Extracted the wzpaloqi.0.cs file. Writting to wzpaloqi.0.cs
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Extracting and decrypting the loader_stub. Writting result to loader_stub.exe
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Parsing loader_stub.exe to decrypt the final executable...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Resource <span style="color:#e6db74">&#39;payload.txt&#39;</span> extracted to <span style="color:#e6db74">&#39;payload_extracted.txt&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Main method found:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Module: tmpBBD0.tmp
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Method: System.Void qCaVAPJGIk.OItkKtykOO::Main<span style="color:#f92672">(</span>System.String<span style="color:#f92672">[])</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Loading instructions of Main...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Key found: <span style="color:#e6db74">&#34;8AOx7b0fGddReqjf+6WzB7n6yOJGvgsGZXvpBa9764w=&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> IV found: <span style="color:#e6db74">&#34;T1D5QuS4MCdJRbPrcYCB/Q==&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Original executable recovered successfully. Writing to <span style="color:#e6db74">&#39;target_exe.exe&#39;</span>...
</span></span><span style="display:flex;"><span>                                                                                                                                                                                                                                            
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>connar㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Documents/JlaiveCustomDeobfuscator<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ls
</span></span><span style="display:flex;"><span>cleared_Jlaive.ps1  dnlib-4.4.0  loader_stub.exe  obfuscated.bat  payload_extracted.txt  target_exe.exe  tmp_Jlaive.ps1  unjlaive.py  wzpaloqi.0.cs
</span></span></code></pre></div><p><strong>References</strong></p>
<blockquote>
    <ul>
        <li> [1] <a href="https://www.scmagazine.com/news/obfuscation-batcloak-80-percent-av-engines">scmagazine: <i>Obfuscation tool ‘BatCloak’ evades 80% of AV engines</i></a></li>
        <li> [2] <a href="https://jstnk9.github.io/jstnk9/research/Jlaive-Antivirus-Evasion-Tool/">Jose Luis Sánchez Martínez: <i>Using Jlaive to create batch files from .NET assemblies for defense evasion</i></a></li>
        <li> [3] <a href="https://github.com/Dump-GUY/Get-UnJlaive">Dump-GUY: <i>Get-UnJlaive</i></a></li>
        <li> [3] <a href="https://www.youtube.com/watch?v=cKciCTW82I8">DuMp-GuY TrIcKsTeR: <i>Get-UnJlaive - Jlaive Protector Reconstructor</i></a></li>
    </ul>
</blockquote>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://connar.github.io/tags/jlaive/">Jlaive</a></li>
      <li><a href="https://connar.github.io/tags/unjlaive/">UnJlaive</a></li>
      <li><a href="https://connar.github.io/tags/obfuscation/">Obfuscation</a></li>
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://connar.github.io/">Journal of Connar</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
